# MIA-EPT – Membership Inference Attack via Error Prediction for Tabular Data

## Overview
This research presents a novel approach for predicting membership inference attacks (MIA) against models trained on synthetic tabular data. Our method utilizes shadow models, helper machine-learning models, and an attack classifier. Helper models are trained on synthetic datasets generated by the models. Each helper model performs regression or classification tasks, predicting individual column values based on the remaining attributes. For shadow models, prediction errors from helper models on datasets with known membership statuses are used as input features to train the attack classifier. Subsequently, for the target model, prediction errors from helper models on datasets with unknown membership statuses are computed and used as input features by the attack classifier to predict membership status. The key intuition behind our approach is that helper models exhibit lower prediction errors for samples included in the synthetic model's training set, thereby enabling membership detection. Experimental results demonstrate the effectiveness of our method in revealing privacy risks inherent in diffusion-based synthetic data generation.

### Method Steps

1) **Train Helper Models**  
  Train ML-based helper models on synthetic data to predict missing column values for each row.

2) **Feature Extraction from Challenge Points**  
  Use trained helper models on challenge points from both training and test sets to extract features.

- **Feature Design Based on Task Type**  
  - *For classification tasks:*
    - Predicted class
    - Binary indicator for correctness (0 = incorrect, 1 = correct)
  - *For regression tasks:*
    - Predicted value
    - Absolute error
    - Error ratio (normalized error)

3) **Train the Shadow Model**  
  Use the extracted features to train a shadow model that learns to classify whether a record was in the training set.

4) **Membership Prediction**  
  Apply the trained shadow model on the test set to predict membership status for individual records.

---

## Setup Instructions  

### Prerequisites  
Before running the code, ensure you have Python (>=3.8) installed.

To install the required dependencies, run:  

```bash
pip install -r requirements.txt
```  

### Running Steps  
1. **Set up data paths:**  
   - Update the `data_manager.py` file with the correct path to the data folder. This folder should store all datasets, extracted features, and evaluation results.  

2. **Run the full pipeline:**  
   - Execute the following command to generate feature vectors for shadow models and the attack classifier, train the attack classifier, evaluate its performance, and train the final attack classifier with all models:  

   ```bash
   python main.py
   ```  

3. **Evaluate the results:**  
   - The attack classifier is evaluated by training on 25 models and testing on the remaining 5 as validation set.  
   - The evaluation includes computing the **AUC-ROC score** and **TPR@FPR** for different false positive rate (FPR) values.  
   - The final attack classifier is then trained using all available models.

4. **Generate the Final Prediction File:**  
   - Running `main.py` automatically generates a submission file for the model that achieves the highest **TPR@FPR of 10%** based on our validation results.
   - To generate a submission file for a different model, execute the following command with the desired parameters:  

   ```bash
   python create_prediction_folder.py --type_test <type_test> --classifier_model_name <classifier_model_name> --columns_lst <columns_lst> --time <time>
   ```  
   - **Argument Explanation:**  
        - `--type_test <type_test>`: Specifies the type of test being performed (e.g., `blackbox_multi_table` or `blackbox_single_table`).  
        - `--classifier_model_name <classifier_model_name>`: Indicates the classifier model selected based on **high AUC-ROC** and **high TPR@FPR_10** from **results_summary.csv**. Choose from the following: `CatBoost`, `XGBoost`, or `MLP`.  
        - `--columns_lst <columns_lst>`: List of selected feature columns for evaluation, extracted from **results_summary.csv** (e.g., `['actual', 'error', 'error_ratio', 'accuracy']`).  
        - `--time <time>`: A timestamp or identifier for tracking execution. Unlike the other arguments, this value is printed in `main.py` to indicate the group of models to use. (e.g., `20250218_115430_test`). 


## Repository Structure  
```
MIA-EPT/
│── README.md                    # Project documentation
│── requirements.txt             # List of required dependencies
│── main.py                      # Main pipeline execution file
│── argument_parser.py           # Handles argument parsing
│── create_predictions_folder.py # Generates final submission file
│── data.py                      # Data handling functions
│── data_manager.py              # Manages data paths and preprocessing
│── features_extraction.py       # Extracts feature vectors for attack detection
│── metrics.py                   # Computes evaluation metrics
│── run_features_extraction.py   # Script to extract features
│── run_train_classifier.py      # Script to train the attack classifier
│── train_classifier.py          # Contains attack classifier training logic
```

## Our Team

This project was developed as part of academic research conducted at the  
**Cyber Security Research Center, Ben-Gurion University of the Negev**.

- **Eyal German** – MSc Student, Developer  
- **Daniel Samira** – MSc Student, Developer  
- **Prof. Yuval Elovici** – Supervisor  
- **Prof. Asaf Shabtai** – Supervisor 




