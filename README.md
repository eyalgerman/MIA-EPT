# MIA-EPT – Membership Inference Attack via Error Prediction for Tabular Data

## Overview
This research presents a novel approach for predicting membership inference attacks (MIA) against models trained on synthetic tabular data. Our method utilizes shadow models, helper machine-learning models, and an attack classifier. Helper models are trained on synthetic datasets generated by the models. Each helper model performs regression or classification tasks, predicting individual column values based on the remaining attributes. For shadow models, prediction errors from helper models on datasets with known membership statuses are used as input features to train the attack classifier. Subsequently, for the target model, prediction errors from helper models on datasets with unknown membership statuses are computed and used as input features by the attack classifier to predict membership status. The key intuition behind our approach is that helper models exhibit lower prediction errors for samples included in the synthetic model's training set, thereby enabling membership detection. Experimental results demonstrate the effectiveness of our method in revealing privacy risks inherent in diffusion-based synthetic data generation.

## Setup Instructions  

### Prerequisites  
Before running the code, ensure you have Python (>=3.8) installed.

To install the required dependencies, run:  

```bash
pip install -r requirements.txt
```  

### Running Steps  
1. **Set up data paths:**  
   - Update the `data_manager.py` file with the correct path to the data folder. This folder should store all datasets, extracted features, and evaluation results.  

2. **Run the full pipeline:**  
   - Execute the following command to generate feature vectors for shadow models and the attack classifier, train the attack classifier, evaluate its performance, and train the final attack classifier with all models:  

   ```bash
   python main.py
   ```  

3. **Evaluate the results:**  
   - The attack classifier is evaluated by training on 25 models and testing on the remaining 5.  
   - The evaluation includes computing the **AUC-ROC score** and **TPR@FPR** for different false positive rate (FPR) values.  
   - The final attack classifier is then trained using all available models.  
4. **Generate the final prediction file:**  
   - The final prediction file is generated by running:  

   ```bash
   python create_prediction_folder.py --output_folder <output_folder>
   ```  
   - The script selects the best models based on the **results_summary.csv** file from the training set. Models achieving **high AUC-ROC** along with **high TPR@FPR_10** are chosen.  
   - The script runs with the following arguments extracted from the results summary. 




